clear all;
ysol = @(t) t*exp(-t);
a = 1/2; b = 3;
f = @(t,y) (1-t)*y/t;
% h = 1/4;
h = 1/4;
y = [];
t = a:h:b;
y(1) = (1/2)*exp(-1/2);
y(2) =  0.354299856774086;
y(3) =  0.367910600102718;
yp(1) = (1/2)*exp(-1/2);
yp(2) =  0.354299856774086;
yp(3) =  0.367910600102718;
for i = 3:length(t)-1
   yp(i+1) = yp(i) + (h/12)*(23*f(t(i),yp(i))-16*f(t(i-1),yp(i-1)) + 5*f(t(i-2),yp(i-2)));
   y(i+1) = y(i) + (h/24)*(9*f(t(i+1),yp(i+1)) + 19*f(t(i),y(i))-5*f(t(i-1),y(i-1)) + f(t(i-2),y(i-2)));
end 
fplot(ysol)
hold on
plot(t,y,'*')
ylim([0,1])
xlim([0,4])
% h = 0.1
h1 = 0.1;
y1 = [];
t1 = a:h1:b;
y1(1) = (1/2)*exp(-1/2);
y1(2) =  0.329287465407951;
y1(3) =  0.347610453328566;
yp1(1) = (1/2)*exp(-1/2);
yp1(2) =  0.329287465407951;
yp1(3) =  0.347610453328566;
for i = 3:length(t1)-1
   yp1(i+1) = yp1(i) + (h1/12)*(23*f(t1(i),yp1(i))-16*f(t1(i-1),yp1(i-1)) + 5*f(t1(i-2),yp1(i-2)));
   y1(i+1) = y1(i) + (h1/24)*(9*f(t1(i+1),yp1(i+1)) + 19*f(t1(i),y1(i))-5*f(t1(i-1),y1(i-1)) + f(t1(i-2),y1(i-2)));
end 
fplot(ysol)
hold on
plot(t1,y1,'*')
ylim([0,1])
xlim([0,4])
% h = 0.05
h2 = 0.05;
y2 = [];
t2 = a:h2:b;
y2(1) = (1/2)*exp(-1/2);
y2(2) =  0.317322414819307;
y2(3) =  0.329287014300455;
yp2(1) = (1/2)*exp(-1/2);
yp2(2) =  0.317322414819307;
yp2(3) =  0.329287014300455;
for i = 3:length(t2)-1
   yp2(i+1) = yp2(i) + (h2/12)*(23*f(t2(i),yp2(i))-16*f(t2(i-1),yp2(i-1)) + 5*f(t2(i-2),yp2(i-2)));
   y2(i+1) = y2(i) + (h2/24)*(9*f(t2(i+1),yp2(i+1)) + 19*f(t2(i),y2(i))-5*f(t2(i-1),y2(i-1)) + f(t2(i-2),y2(i-2)));
end 
fplot(ysol)
hold on
plot(t2,y2,'*')
ylim([0,1])
xlim([0,4])