-- FreeFem++ v4.12 (Tue Dec  6 18:35:04 CET 2022 - git v4.12)
   file : C:\Users\braya\Desktop\Finitos\Años anteriores\curso\codigos\adveccion.edp
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : /*
    2 : Un script que resuelve, usando FreeFem++ el
    3 : problema:
    4 :
    5 : -eps \Delta u + a.\nabla u = f     en ]0,1[x]0,1[
    6 :                         u  = uD    en la frontera
    7 :
    8 : donde
    9 :
   10 : f  = 0
   11 : uD = 0 en una parte de la frontere del dominio y 1 en la otra
   12 : a = (sqrt(3)/2,1/2) un vector que forma un angulo de 30 grados con el eje x
   13 : */
   14 :
   15 : // generando la malla
   16 : mesh Th=square(100,100);
   17 : plot(Th,wait=1);
   18 :
   19 : // Definicion del espacio H_h  (P_1)
   20 : fespace Vh(Th,P2);
   21 : Vh uh,vh;
   22 :
   23 : // Definicion de los datos
   24 : real eps = 1.0e-03;
   25 : func f   = 0.0;
   26 : func uD1 = 0.0;
   27 : func uD2 = 1.0;
   28 : func aa = [sqrt(3.0)/2.0,0.5];  // vector con 30 grados
   29 :
   30 :
   31 : // Macro que define el gradiente de una funcion
   32 : macro Grad(u)[dx(u),dy(u)] )  //
   33 :
   34 : // Solucion del proble discreto: a(u_h,v_h) - F(v_h) = 0 (con condiciones de Dirichlet)
   35 :   solve Poisson(uh,vh) = int2d(Th)(eps*(Grad(uh)[dx(uh),dy(uh)]'*Grad(vh)[dx(vh),dy(vh)]) + (aa'*Grad(uh)[dx(uh),dy(uh)])*vh)
   36 :                                    - int2d(Th)( f*vh) + on(1,2,uh=uD1) + on(3,4,uh=uD2);
   37 :
   38 : // Gr'afica de la solucion numerica
   39 : plot(uh,dim=2,fill=true,value=true,boundary=false);
   40 :
   41 :  sizestack + 1024 =1904  ( 880 )
 
  -- Square mesh : nb vertices  =10201 ,  nb triangles = 20000 ,  nb boundary edges 400
  -- Solve :
          min -1.65505e-30  max 1.24944
times: compile 0.065s, execution 0.556s,  mpirank:0
 ######## We forget of deleting   44 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3777,  size :507248 mpirank: 0
Ok: Normal End
 try getConsole C:\Users\braya\Desktop\Finitos\Años anteriores\curso\codigos\adveccion.edp
